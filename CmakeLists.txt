project(Spp)

cmake_minimum_required(VERSION 3.16)

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)


# Google test
add_subdirectory(extern/gtest)
include(GoogleTest)

macro(spp_test _target _src _test_src)
  set(_all_src "${_src}" "${_test_src}")
  message(STATUS "Setting tests for ${_target}")
  message(STATUS "src: ${_src}")
  message(STATUS "test src: ${_test_src}")
  add_executable(${_target} "${_all_src}")
  target_link_libraries("${_target}" gtest_main)
  unset(_all_src)
endmacro()

set(_RATIONAL_SRC "smart_num/rational/rational.h" "util/concept.h")
set(_RATIONAL_TEST_SRC "smart_num/rational/rational_test.cpp")

set(_SMART_NUM_SRC "smart_num/smart_num.h" "util/concept.h" "${_RATIONAL_SRC}")
set(_SMART_NUM_TEST_SRC "smart_num/smart_num_test.cpp")

spp_test(rational_test "${_RATIONAL_SRC}" "${_RATIONAL_TEST_SRC}")
spp_test(smart_num_test "${_SMART_NUM_SRC}" "${_SMART_NUM_TEST_SRC}")
